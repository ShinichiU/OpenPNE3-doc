=========================================
プラグインから SNS 名称変更機能を利用する
=========================================

SNS 名称変更とは
================

coming soon...

プログラムから、定義されている名称を使用する
============================================

現状、 OpenPNE3 Platform 側では以下の名称設定に対応しています。

* フレンド
* マイフレンド
* コミュニティ
* ニックネーム

これらの定義は、 lib/config/config/sns_term.yml にて知ることができます。

たとえばフレンドの場合の定義は以下のようになっています::

  friend:
   caption:
     ja_JP: "フレンド"
     en: "Friend"

定義中の一番上の friend が識別子となり、プログラムから利用されます。

現状の対応言語は日本語と英語です。なお、英語は条件によって形を変えることがあります。

基本的な使用例
--------------

この friend を使用した文章を記述したい場合、たとえばテンプレート上では以下のように記述します::

<?php echo __('This is your %friend%') ?>

__() ヘルパー関数の内部でコールされる opI18N::__() メソッドによって、 %friend% が自動的に、設定された名称に置換されます。

文頭の単語が置換対象となる場合は、以下のように最初の文字を大文字にして記述してください::

<?php echo __('%Friend% is removed'); ?>

もちろんテンプレートだけでなく、 opI18N によって翻訳をおこなうすべての場面で置換がおこなわれます。（フォームラベルは自動的に各単語の最初の文字が大文字になります）

複雑な使用例
------------

ほとんどの場合、「基本的な使用例」に示したとおりの記述で事足りると思いますが、語を複数形にする必要があるシチュエーションなども考えられます。

その場合、テンプレート上で以下のように記述してください::

<?php echo __('They are your %friend%', array('%friend%' => $op_term['friend']->pluralize())); ?>

また、語が文頭に来て、かつ複数形にしたい場合は、以下のように記述することで対応できます::

<?php echo __('%friend% are removed.', array('%friend%' => $op_term['friend']->pluralize()->fronting())); ?>

$op_term は名称変更設定を管理する SnsTermTable のインスタンスで、 ArrayAccess インターフェースを実装しています。 $op_term['friend'] のように指定することで、 friend の名称変更設定に対応した SnsTerm モデルのインスタンスが取得できます。 SnsTerm は語形変化のためのいくつかのメソッドを実装しています。二番目の例のように、これらのメソッドはメソッドチェーンすることができます。

語形を変化させる用途で利用できる SnsTerm のメソッドを以下に挙げます。

* fronting() : 文頭にくる語として適切な形に変換する（英語の場合、最初の文字を大文字にする。日本語の場合は変化なし）
* titleize() : 表題として用いる語として適切な形に変換する（英語の場合、すべての単語の最初の文字を大文字にする。日本語の場合は変化なし）
* pluralize() : 語を複数形にする（日本語の場合は変化なし）
* withArticle() : 冠詞を付ける（日本語の場合は変化なし）

プラグイン独自の名称を定義する
==============================

プラグイン内に config/sns_term.yml を作成し、 OpenPNE3 Platform と同じように記述することで独自の名称を追加することができます。

その後、デフォルト値を fixture ファイルで SnsTerm モデルに保存してください。
以下に、 pc_frontend 向けに friend の名称のデフォルト値を定義するための fixture ファイルのサンプルを示します::

  SnsTerm:
   term_friend_pc_frontend:
     name: "friend"
     application: "pc_frontend"
     Translation:
       ja_JP:
         value: "フレンド"
       en:
         value: "friend"

name が識別子と対応する値、 application が使用するアプリケーションになります（現状、 pc_frontend か mobile_frontend）。

Translation の各言語の value に、デフォルトの名称を記述してください。
